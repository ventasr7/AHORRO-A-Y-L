<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>VS de Apuesta</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; }
        .bar-container { display: flex; flex-direction: column; gap: 16px; margin: 32px 0 20px 0; }
        .bar-label { margin-bottom: 4px; font-weight: bold; font-size: 18px; }
        .bar-bg {
            background: #e0e0e0;
            border-radius: 20px;
            overflow: hidden;
            height: 40px;
            position: relative;
            box-shadow: 0 2px 8px #ccc;
        }
        .bar-inner {
            height: 100%;
            display: flex;
            align-items: center;
            padding-left: 16px;
            color: #fff;
            font-weight: bold;
            font-size: 18px;
            transition: width 0.5s;
            letter-spacing: 1px;
        }
        .azul-bar { background: linear-gradient(90deg, #0074D9 70%, #00cfff 100%); }
        .rojo-bar { background: linear-gradient(90deg, #FF4136 70%, #ff7b6b 100%); }
        .registro, .apuesta, .historial { background: #fff; padding: 20px; margin: 20px auto; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px #ccc; }
        .apuesta input { width: 80px; }
        .btn { padding: 8px 16px; border: none; border-radius: 4px; background: #0074D9; color: #fff; cursor: pointer; }
        .btn.eliminar { background: #FF4136; }
        .hidden { display: none; }
        ul { padding: 0; }
        li { list-style: none; margin: 8px 0; }
    </style>
</head>
<body>
    <div class="bar-container">
        <div class="bar-label" style="color: #0074D9;">AZUL</div>
        <div class="bar-bg">
            <div class="bar-inner azul-bar" id="barraAzul">$0 (0%)</div>
        </div>
        <div class="bar-label" style="color: #FF4136; margin-top: 12px;">ROJO</div>
        <div class="bar-bg">
            <div class="bar-inner rojo-bar" id="barraRojo">$0 (0%)</div>
        </div>
    </div>

    <div class="registro" id="registroDiv">
        <h2>Registro</h2>
        <label>Nombre de tu equipo:</label>
        <input type="text" id="nombreEquipo" required>
        <br><br>
        <label>Elige tu color:</label>
        <select id="colorEquipo">
            <option value="azul">Azul</option>
            <option value="rojo">Rojo</option>
        </select>
        <br><br>
        <button class="btn" onclick="registrarEquipo()">Registrar</button>
    </div>

    <div class="apuesta hidden" id="apuestaDiv">
        <h2>Meta: $100,000</h2>
        <p>Equipo: <span id="equipoNombre"></span> (<span id="equipoColor"></span>)</p>
        <label>Cantidad a apostar:</label>
        <input type="number" id="cantidadApuesta" min="1">
        <button class="btn" onclick="guardarApuesta()">Guardar</button>
    </div>

    <div class="historial hidden" id="historialDiv">
        <h3>Historial de apuestas</h3>
        <ul id="listaApuestas"></ul>
    </div>

    <script>
        const meta = 100000;
        let equipo = JSON.parse(localStorage.getItem('equipo')) || null;
        let apuestas = JSON.parse(localStorage.getItem('apuestas')) || [];

        function actualizarBarras() {
            let azul = apuestas.filter(a => a.color === 'azul').reduce((s, a) => s + a.cantidad, 0);
            let rojo = apuestas.filter(a => a.color === 'rojo').reduce((s, a) => s + a.cantidad, 0);
            let azulPorc = Math.min(100, Math.round((azul / meta) * 100));
            let rojoPorc = Math.min(100, Math.round((rojo / meta) * 100));
            document.getElementById('barraAzul').style.width = azulPorc + '%';
            document.getElementById('barraAzul').textContent = `$${azul} (${azulPorc}%)`;
            document.getElementById('barraRojo').style.width = rojoPorc + '%';
            document.getElementById('barraRojo').textContent = `$${rojo} (${rojoPorc}%)`;
        }

        function mostrarHistorial() {
            const lista = document.getElementById('listaApuestas');
            lista.innerHTML = '';
            apuestas.forEach((a, i) => {
                if (a.equipo === equipo.nombre && a.color === equipo.color) {
                    let li = document.createElement('li');
                    li.textContent = `$${a.cantidad} `;
                    let btn = document.createElement('button');
                    btn.textContent = 'Eliminar';
                    btn.className = 'btn eliminar';
                    btn.onclick = () => eliminarApuesta(i);
                    li.appendChild(btn);
                    lista.appendChild(li);
                }
            });
        }

        function registrarEquipo() {
            const nombre = document.getElementById('nombreEquipo').value.trim();
            const color = document.getElementById('colorEquipo').value;
            if (!nombre) return alert('Pon el nombre de tu equipo');
            equipo = { nombre, color };
            localStorage.setItem('equipo', JSON.stringify(equipo));
            mostrarApuesta();
        }

        function mostrarApuesta() {
            document.getElementById('registroDiv').classList.add('hidden');
            document.getElementById('apuestaDiv').classList.remove('hidden');
            document.getElementById('historialDiv').classList.remove('hidden');
            document.getElementById('equipoNombre').textContent = equipo.nombre;
            document.getElementById('equipoColor').textContent = equipo.color.toUpperCase();
            actualizarBarras();
            mostrarHistorial();
        }

        function guardarApuesta() {
            const cantidad = parseInt(document.getElementById('cantidadApuesta').value);
            if (!cantidad || cantidad < 1) return alert('Pon una cantidad válida');
            apuestas.push({ equipo: equipo.nombre, color: equipo.color, cantidad });
            localStorage.setItem('apuestas', JSON.stringify(apuestas));
            document.getElementById('cantidadApuesta').value = '';
            actualizarBarras();
            mostrarHistorial();
        }

        function eliminarApuesta(idx) {
            apuestas.splice(idx, 1);
            localStorage.setItem('apuestas', JSON.stringify(apuestas));
            actualizarBarras();
            mostrarHistorial();
        }

        // Al cargar la página
        if (equipo) {
            mostrarApuesta();
        } else {
            document.getElementById('registroDiv').classList.remove('hidden');
        }
        actualizarBarras();
    </script>
